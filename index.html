<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Biomedical Service Report</title>
  <style>
    body{font-family:Arial, sans-serif;background:#f3f6fb;margin:0;color:#222;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}
    .container{max-width:600px;margin:0 auto;padding:15px;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
    h1{color:#0b74de;font-size:20px;margin-bottom:10px;text-align:center}
    h3{margin-top:0;color:#0b74de;font-size:16px;text-align:center}
    .section{border:1px dashed #cfe4ff;padding:12px;border-radius:8px;margin-bottom:12px;background:#fbfdff}
    .row{display:flex;flex-direction:column;gap:10px}
    .col{width:100%}
    label{font-size:14px;color:#555;margin-bottom:4px;display:block}
    input,textarea{width:100%;padding:14px;border:1px solid #ccd8e6;border-radius:10px;font-size:18px;-webkit-appearance:none;appearance:none}
    textarea{resize:vertical;min-height:60px}
    .sig-wrap{display:flex;flex-direction:column;gap:20px;margin-top:15px}
    .sig-box{text-align:center}
    canvas{border:1px solid #ccd8e6;border-radius:10px;width:100%;height:160px;touch-action: none;background:#fff}
    .btn{background:#0b74de;color:#fff;border:none;padding:16px;border-radius:10px;cursor:pointer;font-weight:bold;margin-top:15px;width:100%;font-size:18px;-webkit-tap-highlight-color: transparent;}
    .btn.clear{background:#ccc;color:#000;margin-top:10px}
    input:focus,textarea:focus{outline:3px solid #b5d5ff}
  </style>
</head>
<body>
<div class="container" id="report">
  <h1>Biomedical Service Report</h1>

  <div class="section">
    <h3>Complaint Information</h3>
    <div class="row">
      <div class="col"><label>Date</label><input type="date" id="c_date"></div>
      <div class="col"><label>Time</label><input type="time" id="c_time"></div>
      <div class="col"><label>Department</label><input type="text" id="c_dept"></div>
    </div>
  </div>

  <div class="section">
    <h3>Equipment Details</h3>
    <div class="row">
      <div class="col"><label>Equipment</label><input type="text" id="eq_name"></div>
      <div class="col"><label>Model</label><input type="text" id="eq_model"></div>
      <div class="col"><label>Make</label><input type="text" id="eq_make"></div>
      <div class="col"><label>Serial Number</label><input type="text" id="eq_serial"></div>
    </div>
  </div>

  <div class="section">
    <h3>Problem & Resolution</h3>
    <div class="row">
      <div class="col"><label>Problem Reported</label><textarea id="problem"></textarea></div>
      <div class="col"><label>Action Taken</label><textarea id="action"></textarea></div>
    </div>
  </div>

  <div class="section">
    <h3>Completion Details</h3>
    <div class="row">
      <div class="col"><label>Finish Date</label><input type="date" id="f_date"></div>
      <div class="col"><label>Finish Time</label><input type="time" id="f_time"></div>
      <div class="col"><label>Down Time (hours)</label><input type="text" id="down_time" readonly></div>
      <div class="col"><label>Repaired By</label><input type="text" id="repaired_by"></div>
      <div class="col"><label>Spare Parts Used</label><textarea id="spares"></textarea></div>
      <div class="col"><label>Cause of Failure</label><textarea id="cause"></textarea></div>
    </div>
  </div>

  <div class="sig-wrap">
    <div class="sig-box">
      <label>User Signature</label>
      <canvas id="user_sign"></canvas>
      <button class="btn clear" onclick="clearCanvas('user_sign')">Clear</button>
    </div>
    <div class="sig-box">
      <label>Engineer Signature</label>
      <canvas id="eng_sign"></canvas>
      <button class="btn clear" onclick="clearCanvas('eng_sign')">Clear</button>
    </div>
  </div>

  <button class="btn" onclick="generatePDF()">Generate PDF</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  function clearCanvas(id){const c=document.getElementById(id);c.getContext('2d').clearRect(0,0,c.width,c.height)}
  function generatePDF(){
    const { jsPDF } = window.jspdf;
    html2canvas(document.getElementById('report')).then(canvas=>{
      const imgData=canvas.toDataURL('image/png');
      const pdf=new jsPDF('p','pt','a4');
      const pageWidth=pdf.internal.pageSize.getWidth();
      const pageHeight=pdf.internal.pageSize.getHeight();
      const imgWidth=pageWidth-40;
      const imgHeight=canvas.height*imgWidth/canvas.width;
      let y=20;
      pdf.addImage(imgData,'PNG',20,y,imgWidth,imgHeight);
      pdf.save('Service_Report.pdf');
    });
  }
</script>
</body>
</html>
